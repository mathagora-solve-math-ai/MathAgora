# LLM Step 파싱 추가

1. Step 프롬프트 구체화
2. 구체화 후 성능 비교

# 1. LLM 응답이 Step 단위로 잘 쪼개지는지

**LLM 풀이 방식 ablation**

1. 그냥 풀기: 단순 “문제 풀어라” → 개행(\n) 기준으로 step 파싱
2. 단계별로 풀기: “step by step으로 풀어라” → 번호 패턴이나 마크다운 heading 기준 파싱
3. Step 마킹하면서 풀기: “step 별 소제목과 함께 step by step으로 풀어라” → 정해진 format 따라서 출력 강제, 파싱
4. **Step 기준 구체화**: “step 태그 포맷으로 출력하되, 풀이의 흐름(전략/접근)이 바뀌는 전환점마다만 step을 나눠라” → step granularity 제어

### 예제

- **그냥 풀기 예제**
    
    ```
    # 프롬프트
    
    다음 수학 문제를 풀어주세요.
    
    문제:
    {problem}
    
    # 풀이
    
    함수  
    \\[
    f(x)=\\frac13x^3-2x^2-12x+4
    \\]
    의 극대/극소는 도함수 \\(f'(x)=0\\)인 점에서 결정됩니다.
    
    1) 도함수:
    \\[
    f'(x)=x^2-4x-12
    \\]
    
    2) 임계점(해) 구하기:
    \\[
    x^2-4x-12=0 \\quad\\Rightarrow\\quad (x-6)(x+2)=0
    \\]
    따라서 \\(x=6,\\,-2\\).
    
    3) 극대/극소 판별(이차도함수):
    \\[
    f''(x)=2x-4
    \\]
    - \\(x=-2\\)에서 \\(f''(-2)=-8<0\\) 이므로 극대 \\(\\Rightarrow \\alpha=-2\\)
    - \\(x=6\\)에서 \\(f''(6)=8>0\\) 이므로 극소 \\(\\Rightarrow \\beta=6\\)
    
    4) \\(\\beta-\\alpha\\):
    \\[
    \\beta-\\alpha = 6-(-2)=8
    \\]
    
    정답: **⑤ 8**
    ```
    
- **단계별로 풀기 예제**
    
    ```
    # 프롬프트
    
    다음 수학 문제를 단계별(step-by-step)로 풀어주세요.
    
    문제:
    {problem}
    
    # 풀이
    
    함수  
    \\[
    f(x)=\\frac13x^3-2x^2-12x+4
    \\]
    가 \\(x=\\alpha\\)에서 극대, \\(x=\\beta\\)에서 극소이므로 \\(\\alpha,\\beta\\)는 **도함수 \\(f'(x)=0\\)**의 해입니다.
    
    ---
    
    ## 1) 도함수 구하기
    \\[
    f'(x)=\\left(\\frac13x^3\\right)'- (2x^2)'-(12x)'+4'
    = x^2-4x-12
    \\]
    
    ---
    
    ## 2) 극값 조건: \\(f'(x)=0\\) 풀기
    \\[
    x^2-4x-12=0
    \\]
    인수분해하면
    \\[
    (x-6)(x+2)=0
    \\]
    따라서
    \\[
    x=6,\\quad x=-2
    \\]
    
    ---
    
    ## 3) 어느 쪽이 극대/극소인지 판단
    이차식 \\(f'(x)=x^2-4x-12\\)는 위로 열린 포물선이므로,
    
    - 근 사이 \\((-2,6)\\)에서는 \\(f'(x)<0\\) (감소)
    - 바깥에서는 \\(f'(x)>0\\) (증가)
    
    즉,
    - \\(x=-2\\)에서는 \\(+\\to-\\)로 바뀌므로 **극대** → \\(\\alpha=-2\\)
    - \\(x=6\\)에서는 \\(-\\to+\\)로 바뀌므로 **극소** → \\(\\beta=6\\)
    
    ---
    
    ## 4) \\(\\beta-\\alpha\\) 계산
    \\[
    \\beta-\\alpha = 6-(-2)=8
    \\]
    
    ---
    
    ## 정답
    \\[
    \\boxed{8}
    \\]
    따라서 **⑤ 8** 입니다.
    ```
    
- **마킹하면서 풀기 예제**
    
    ```
    # 프롬프트
    
    다음 수학 문제를 단계별(step-by-step)로 풀어주세요.
    각 단계마다 **간결한 제목**(예: "조건 정리", "인수분해")을 붙여주세요.
    
    출력 형식:
    [STEP title="<간결한 제목>"]
    <풀이 내용>
    
    [FINAL_ANSWER]
    <최종 답>
    
    문제:
    {problem}
    
    # 풀이
    
    [STEP title=\"도함수 구하기\"]
    \\(f(x)=\\dfrac{1}{3}x^3-2x^2-12x+4\\) 이므로  
    \\[
    f'(x)=x^2-4x-12
    \\]
    
    [STEP title=\"극값 조건(임계점) 찾기\"]
    극대/극소는 \\(f'(x)=0\\) 인 점에서 발생하므로
    
    \\[
    
    x^2-4x-12=0
    \\]
    \\[
    (x-6)(x+2)=0
    \\]\
    따라서 임계점은 \\(x=6,\\,-2\\) 이다.
    
    [STEP title=\"극대/극소 위치 판별\"]
    이차식 \\(f'(x)=x^2-4x-12\\) 는 위로 열린 포물선이므로  
    근 사이에서 \\(f'(x)<0\\), 근 바깥에서 \\(f'(x)>0\\).
    
    - \\(x=-2\\)에서: \\(f'(x)\\)가 \\(+\\to-\\) 로 변하므로 **극대** \\(\\Rightarrow \\alpha=-2\\)
    - \\(x=6\\)에서: \\(f'(x)\\)가 \\(-\\to+\\) 로 변하므로 **극소** \\(\\Rightarrow \\beta=6\\)
    
    [STEP title=\"차이 계산\"]
    \\[
    \\beta-\\alpha = 6-(-2)=8
    \\]
    
    [FINAL_ANSWER]
    8 (⑤)
    ```
    
- **Step 기준 구체화 예제**
    
    ```
    # 프롬프트
    
    다음 수학 문제를 단계별(step-by-step)로 풀어주세요.
    각 단계마다 간결한 제목(예: “조건 정리”, “인수분해”)을 붙여주세요.
    STEP은 풀이의 흐름(전략/접근)이 바뀌는 지점마다 구분하되, 의미 없는 세분화는 피하고 필요한 만큼만 나누세요.
    
    출력 형식:
    [STEP title=”<간결한 제목>”]
    <풀이 내용>
    
    [FINAL_ANSWER]
    <최종 답>
    
    문제:
    {problem}
    
    # 풀이
    
    [STEP title=“도함수로 극값 위치 찾기”]
    함수
    f(x)=\dfrac13x^3-2x^2-12x+4
    의 극대/극소는 f'(x)=0이 되는 점에서 발생합니다.
    
    먼저 도함수를 구하면
    f'(x)=\left(\dfrac13x^3\right)'- (2x^2)' - (12x)' + 4'
    = x^2 -4x -12
    
    [STEP title=“방정식 풀이 및 후보점 정리”]
    x^2-4x-12=0
    인수분해하면
    x^2-4x-12=(x-6)(x+2)=0
    따라서 임계점은
    x=6,\quad x=-2
    
    [STEP title=“극대/극소 판별”]
    이제 두 점이 극대인지 극소인지 판별하기 위해 이계도함수를 사용합니다.
    
    f''(x)=(x^2-4x-12)'=2x-4
    	•	x=-2에서
    f''(-2)=2(-2)-4=-8<0
    이므로 x=-2는 극대 → \alpha=-2
    	•	x=6에서
    f''(6)=2(6)-4=8>0
    이므로 x=6은 극소 → \beta=6
    
    [STEP title=“β − α 계산”]
    \beta-\alpha=6-(-2)=8
    
    [FINAL_ANSWER]
    8
    ```
    

### **실제 step 수 비교**

| 프롬프트 | 7번 (쉬움) | 22번 (어려움) |
| --- | --- | --- |
| 그냥 풀기 | 6 | **39** |
| 단계별로 풀기 | 13 | **44** |
| Step 마킹하면서 풀기 | **4** | **6** |
| Step 기준 구체화 | 4 | 5 |

# 2. 구체화 후 성능 비교

### Step 마킹 예제

**7번 문제 | GPT 5.2** 

```
[STEP title="도함수 구하기"]
\(f(x)=\dfrac{1}{3}x^3-2x^2-12x+4\) 이므로  
\[
f'(x)=x^2-4x-12
\]

[STEP title="임계점(극값 후보) 찾기"]
극대/극소는 \(f'(x)=0\)에서 발생하므로
\[
x^2-4x-12=0
\]
\[
(x-6)(x+2)=0
\]
따라서 임계점은 \(x=6,\,-2\) 이다.

[STEP title="극대/극소 판별"]
\[
f''(x)=2x-4
\]
- \(x=-2\)에서  
\[
f''(-2)=2(-2)-4=-8<0 \Rightarrow \text{극대}
\]
따라서 \(\alpha=-2\).

- \(x=6\)에서  
\[
f''(6)=12-4=8>0 \Rightarrow \text{극소}
\]
따라서 \(\beta=6\).

[STEP title="요구값 계산"]
\[
\beta-\alpha=6-(-2)=8
\]

[FINAL_ANSWER]
\(\beta-\alpha=8\) (⑤)
```

**7번 문제 | Claude Opus 4.5**

```
[STEP title="도함수 구하기"]
극대와 극소를 찾기 위해 $f(x)$를 미분합니다.

$$f(x) = \frac{1}{3}x^3 - 2x^2 - 12x + 4$$

$$f'(x) = x^2 - 4x - 12$$
[/STEP]

[STEP title="임계점 찾기"]
극값이 되는 점에서 $f'(x) = 0$이므로:

$$x^2 - 4x - 12 = 0$$

인수분해하면:
$$(x-6)(x+2) = 0$$

따라서 $x = 6$ 또는 $x = -2$
[/STEP]

[STEP title="극대와 극소 판별"]
$f'(x) = (x-6)(x+2)$의 부호를 분석합니다.

| 구간 | $x < -2$ | $-2 < x < 6$ | $x > 6$ |
|------|----------|--------------|---------| 
| $f'(x)$ | $+$ | $-$ | $+$ |
| $f(x)$ | 증가 | 감소 | 증가 |

- $x = -2$: 증가 → 감소 → **극대** ($\alpha = -2$)
- $x = 6$: 감소 → 증가 → **극소** ($\beta = 6$)
[/STEP]

[STEP title="β - α 계산"]
$$\beta - \alpha = 6 - (-2) = 8$$
[/STEP]

[FINAL_ANSWER]
**⑤ 8**
```

**7번 문제 | Gemini 3 Pro Preview**

```
[STEP title="도함수 구하기"]
함수 $f(x)=\dfrac{1}{3}x^3-2x^2-12x+4$의 극값을 구하기 위해 $x$에 대하여 미분합니다.
$$f'(x) = x^2 - 4x - 12$$

[STEP title="인수분해 및 0이 되는 값 찾기"]
도함수 $f'(x)=0$이 되는 $x$의 값을 구하기 위해 인수분해합니다.
$$x^2 - 4x - 12 = (x-6)(x+2) = 0$$
따라서 $x=6$ 또는 $x=-2$입니다.

[STEP title="극대, 극소 판별"]
최고차항의 계수가 양수인 3차 함수이므로, 그래프의 개형은 증가하다가 감소하고 다시 증가하는 형태입니다.
따라서 $x$값이 작은 쪽에서 극대, 큰 쪽에서 극소를 가집니다.
- $x=-2$에서 극대이므로 $\alpha = -2$
- $x=6$에서 극소이므로 $\beta = 6$

[STEP title="값 계산"]
구하려는 값 $\beta - \alpha$를 계산합니다.
$$\beta - \alpha = 6 - (-2) = 6 + 2 = 8$$

[FINAL_ANSWER]
⑤ 8

```

**22번 문제 | GPT 5.2** 

```
[STEP title="조건 해석(부호 조건)"]
정수 \(k\)에 대해 \(f(k-1)f(k+1)<0\) 인 \(k\)가 **없다**는 것은,
모든 정수 \(k\)에 대해
\[
f(k-1),\ f(k+1)
\]
가 **서로 부호가 다르게 나오는 일이 없다**는 뜻이다.  
즉 모든 정수 \(n\)에 대해
\[
f(n)\,f(n+2)\ge 0
\]
가 성립한다. (짝수 간격으로 떨어진 정수점들에서 부호가 바뀌지 않음)

따라서 정수에서의 부호 변화는 (가능하다면) **짝수열(…,-2,0,2,4,…)**과 **홀수열(…,-1,1,3,5,…)** 각각 내부에서는 일어나지 않는다.

---

[STEP title="도함수 조건으로 \(f'(x)\) 결정"]
\(f(x)\)는 최고차항 계수가 1인 삼차함수이므로
\[
f(x)=x^3+ax^2+bx+c,\qquad f'(x)=3x^2+2ax+b.
\]

조건 \(f'\!\left(-\frac14\right)=-\frac14\)에서
\[
3\left(\frac{1}{16}\right)+2a\left(-\frac14\right)+b=-\frac14
\]
\[
\frac{3}{16}-\frac{a}{2}+b=-\frac14
\Rightarrow b-\frac{a}{2}=-\frac{7}{16}\quad (1)
\]

또 \(f'\!\left(\frac14\right)<0\) 이므로
\[
3\left(\frac{1}{16}\right)+2a\left(\frac14\right)+b<0
\]
\[
\frac{3}{16}+\frac{a}{2}+b<0
\Rightarrow b+\frac{a}{2}<-\frac{3}{16}\quad (2)
\]

(1)에서 \(b=\frac{a}{2}-\frac{7}{16}\). 이를 (2)에 대입하면
\[
\left(\frac{a}{2}-\frac{7}{16}\right)+\frac{a}{2}<-\frac{3}{16}
\Rightarrow a-\frac{7}{16}<-\frac{3}{16}
\Rightarrow a<\frac14.
\]

---

[STEP title="정수 부호 조건을 만족하는 형태 추론"]
정수에서 \(f(n)f(n+2)\ge 0\)가 항상 성립하려면,
그래프가 정수점들 사이에서 자주 부호를 바꾸면 안 된다.

삼차함수는 실근이 1개 또는 3개인데, 정수열(짝수/홀수)에서 부호가 바뀌려면 해당 열 사이에 근이 끼어야 한다.  
그런데 "모든 \(n\)에 대해 \(f(n)\)과 \(f(n+2)\)가 같은 부호(또는 0)"이려면, 각 열(짝수열/홀수열)에서는 **근을 많아야 1개만** 가질 수 있고, 그 근이 있더라도 그 열에서 부호가 바뀌지 않으려면 그 정수에서 **중근(짝수차)**이어야 한다.

삼차함수에서 가능한 "짝수차 근"은 **중근(2중근)**뿐이므로,
정수 부호 조건을 자연스럽게 만족하는 대표 형태는
\[
f(x)=(x-m)^2(x-n)
\]
이며, 여기서 \(m\)은 정수(중근 위치), \(n\)은 실수(단근 위치)로 두는 것이 가장 안정적이다. (중근에서는 부호가 바뀌지 않음)

---

[STEP title="도함수 조건을 \((x-m)^2(x-n)\)에 적용"]
\[
f(x)=(x-m)^2(x-n).
\]
전개하면
\[
f(x)=x^3-(n+2m)x^2+(m^2+2mn)x-m^2n
\]
따라서
\[
a=-(n+2m),\quad b=m^2+2mn.
\]

또한
\[
f'(x)=3x^2-2(n+2m)x+(m^2+2mn).
\]

조건 \(f'\!\left(-\frac14\right)=-\frac14\):
\[
3\cdot\frac{1}{16}-2(n+2m)\left(-\frac14\right)+(m^2+2mn)=-\frac14
\]
\[
\frac{3}{16}+\frac{n+2m}{2}+m^2+2mn=-\frac14
\]
\[
m^2+2mn+\frac{n+2m}{2}+\frac{7}{16}=0 \quad (A)
\]

또 \(f'\!\left(\frac14\right)<0\):
\[
\frac{3}{16}-\frac{n+2m}{2}+m^2+2mn<0
\]
\[
m^2+2mn-\frac{n+2m}{2}+\frac{3}{16}<0 \quad (B)
\]

---

[STEP title="정수 \(m\) 선택 (부호 조건과 결합)"]
중근 \(m\)이 정수여야 정수열에서 부호가 안정적이다. 또한 문제에서 \(f(8)\)을 묻고 있으므로, 값이 깔끔하게 결정되는 전형적 상황은 중근이 작은 정수에 놓이는 경우이다.

(A)를 정리하기 위해 \(n\)에 대해 풀어보면:
\[
m^2+2mn+\frac{n}{2}+m+\frac{7}{16}=0
\]
\[
n\left(2m+\frac12\right)=-(m^2+m+\frac{7}{16})
\]
\[
n\left(\frac{4m+1}{2}\right)=-\left(m^2+m+\frac{7}{16}\right)
\]
\[
n=-\frac{2\left(m^2+m+\frac{7}{16}\right)}{4m+1}
=-\frac{2m^2+2m+\frac{7}{8}}{4m+1}.
\]

\(m\)이 정수일 때 \(n\)이 단순해지려면 \(4m+1\)이 분모를 잘 나눠야 한다. 작은 정수 \(m\)을 대입해 보면:

- \(m=0\): \(n=-\dfrac{7/8}{1}=-\dfrac78\).
- \(m=-1\): \(4m+1=-3\), 분자 \(2m^2+2m+7/8=2-2+7/8=7/8\) → \(n=-\dfrac{7/8}{-3}=\dfrac{7}{24}\).
- \(m=1\): \(4m+1=5\), 분자 \(2+2+7/8=39/8\) → \(n=-\dfrac{39/8}{5}=-\dfrac{39}{40}\).

이 중 정수 부호 조건을 점검하면, \(m=0\)일 때
\[
f(x)=x^2\left(x+\frac78\right).
\]
이 함수는 \(x=0\)에서 중근(부호 안 바뀜), \(x=-\frac78\)에서 단근(부호 바뀜)인데, \(-\frac78\)은 \(-1\)과 \(0\) 사이에 있으므로 정수값에서
- \(f(-1)=(-1)^2(-1+7/8)=1\cdot(-1/8)<0\),
- \(f(1)=1^2(1+7/8)>0\),
그리고 짝수열/홀수열 각각에서 \(n\)과 \(n+2\)는 같은 쪽에 있으므로 \(f(n)f(n+2)\ge 0\)가 실제로 성립한다. (예: 홀수열은 모두 양수, 짝수열은 \(0\) 포함하여 음수/양수 변화 없음)

이제 (B)도 확인한다.

---

[STEP title="부등식 \(f'(\frac14)<0\) 확인"]
\(m=0,\ n=-\frac78\)이면
\[
f(x)=x^2\left(x+\frac78\right)=x^3+\frac78x^2.
\]
따라서
\[
f'(x)=3x^2+\frac{7}{4}x.
\]
\[
f'\!\left(-\frac14\right)=3\cdot\frac{1}{16}+\frac{7}{4}\left(-\frac14\right)
=\frac{3}{16}-\frac{7}{16}=-\frac{4}{16}=-\frac14
\]
조건 만족.

또
\[
f'\!\left(\frac14\right)=\frac{3}{16}+\frac{7}{16}=\frac{10}{16}=\frac58>0
\]
이므로 \(f'\!\left(\frac14\right)<0\)를 만족하지 못한다.

따라서 \(m=0\)은 탈락.

다음 후보 \(m=-1,\ n=\frac{7}{24}\):
\[
f(x)=(x+1)^2\left(x-\frac{7}{24}\right).
\]
이때 \(f'(x)\)를 직접 계산해 (B)를 확인하면
\[
f'(x)=3x^2-2(n+2m)x+(m^2+2mn)
\]
여기서 \(m=-1,\ n=\frac{7}{24}\)이므로
\[
n+2m=\frac{7}{24}-2=-\frac{41}{24},\quad
m^2+2mn=1+2(-1)\frac{7}{24}=1-\frac{7}{12}=\frac{5}{12}.
\]
따라서
\[
f'(x)=3x^2-2\left(-\frac{41}{24}\right)x+\frac{5}{12}
=3x^2+\frac{41}{12}x+\frac{5}{12}.
\]
\[
f'\!\left(\frac14\right)=3\cdot\frac{1}{16}+\frac{41}{12}\cdot\frac14+\frac{5}{12}
=\frac{3}{16}+\frac{41}{48}+\frac{5}{12}
=\frac{3}{16}+\frac{41}{48}+\frac{20}{48}
=\frac{3}{16}+\frac{61}{48}
=\frac{9}{48}+\frac{61}{48}=\frac{70}{48}>0
\]
역시 \(<0\)가 아니다. 탈락.

세 번째 \(m=1,\ n=-\frac{39}{40}\):
\[
n+2m=-\frac{39}{40}+2=\frac{41}{40},\quad
m^2+2mn=1+2\cdot1\cdot\left(-\frac{39}{40}\right)=1-\frac{39}{20}=-\frac{19}{20}.
\]
\[
f'(x)=3x^2-2\cdot\frac{41}{40}x-\frac{19}{20}
=3x^2-\frac{41}{20}x-\frac{19}{20}.
\]
\[
f'\!\left(\frac14\right)=\frac{3}{16}-\frac{41}{20}\cdot\frac14-\frac{19}{20}
=\frac{3}{16}-\frac{41}{80}-\frac{19}{20}
=\frac{15}{80}-\frac{41}{80}-\frac{76}{80}
=-\frac{102}{80}<0
\]
조건 \(f'\!\left(\frac14\right)<0\) 만족.

또 \(f'\!\left(-\frac14\right)\)는
\[
\frac{3}{16}-\frac{41}{20}\left(-\frac14\right)-\frac{19}{20}
=\frac{3}{16}+\frac{41}{80}-\frac{19}{20}
=\frac{15}{80}+\frac{41}{80}-\frac{76}{80}
=-\frac{20}{80}=-\frac14
\]
조건도 만족.

따라서
\[
f(x)=(x-1)^2\left(x+\frac{39}{40}\right)
\]
로 결정된다.

---

[STEP title="정수 부호 조건 최종 확인"]
근은 \(x=1\) (중근), \(x=-\frac{39}{40}\) (단근)이다.  
단근은 \(-1\)과 \(0\) 사이에 있으므로 정수에서
- \(x\le -1\)이면 \(f(x)<0\),
- \(x=0\)이면 \(f(0)=( -1)^2\cdot \frac{39}{40}>0\),
- \(x\ge 0\)이면 \(f(x)>0\) (단, \(x=1\)에서는 0이지만 부호는 안 바뀜)

따라서 같은 짝수/홀수열에서 2만큼 떨어진 정수들끼리는 부호가 바뀌지 않아
\[
f(n)f(n+2)\ge 0
\]
가 항상 성립한다. 조건 만족.

---

[STEP title="f(8) 계산"]
\[
f(8)=(8-1)^2\left(8+\frac{39}{40}\right)
=7^2\left(\frac{320}{40}+\frac{39}{40}\right)
=49\cdot\frac{359}{40}
=\frac{17591}{40}.
\]

---

[FINAL_ANSWER]
\[
f(8)=\frac{17591}{40}.
\]

```

**22번 문제 | Claude Opus 4.5**

```
[STEP title="조건 정리"]
최고차항의 계수가 1인 삼차함수 $f(x) = x^3 + ax^2 + bx + c$

조건 분석:
- $f(k-1)f(k+1) < 0$을 만족시키는 정수 $k$가 존재하지 않음
- 이는 연속인 두 홀수점 또는 연속인 두 짝수점에서 부호가 바뀌지 않음을 의미
- 즉, $f(x) = 0$의 실근이 있다면, 길이 2인 구간 $(k-1, k+1)$ 안에 모든 실근이 있어야 함

[/STEP]

[STEP title="도함수 조건 설정"]
$f(x) = x^3 + ax^2 + bx + c$

$f'(x) = 3x^2 + 2ax + b$

주어진 조건:
- $f'\left(-\dfrac{1}{4}\right) = 3 \cdot \dfrac{1}{16} - \dfrac{a}{2} + b = \dfrac{3}{16} - \dfrac{a}{2} + b = -\dfrac{1}{4}$
- $f'\left(\dfrac{1}{4}\right) = 3 \cdot \dfrac{1}{16} + \dfrac{a}{2} + b = \dfrac{3}{16} + \dfrac{a}{2} + b < 0$

[/STEP]

[STEP title="a, b 관계 도출"]
첫 번째 조건에서:
$$\dfrac{3}{16} - \dfrac{a}{2} + b = -\dfrac{1}{4}$$
$$b = -\dfrac{1}{4} - \dfrac{3}{16} + \dfrac{a}{2} = -\dfrac{7}{16} + \dfrac{a}{2}$$

두 번째 조건에서:
$$\dfrac{3}{16} + \dfrac{a}{2} + b < 0$$
$$\dfrac{3}{16} + \dfrac{a}{2} + \left(-\dfrac{7}{16} + \dfrac{a}{2}\right) < 0$$
$$-\dfrac{4}{16} + a < 0$$
$$a < \dfrac{1}{4}$$

[/STEP]

[STEP title="극값 조건 분석"]
$f'(x) = 3x^2 + 2ax + b$의 두 근을 $\alpha, \beta$ ($\alpha < \beta$)라 하면:
- $\alpha + \beta = -\dfrac{2a}{3}$
- $\alpha\beta = \dfrac{b}{3}$

$f'\left(-\dfrac{1}{4}\right) = -\dfrac{1}{4} < 0$이고 $f'\left(\dfrac{1}{4}\right) < 0$이므로
$-\dfrac{1}{4}$과 $\dfrac{1}{4}$ 모두 $(\alpha, \beta)$ 구간 안에 있음.

[/STEP]

[STEP title="근의 위치와 조건 연결"]
$f(k-1)f(k+1) < 0$인 정수 $k$가 없으려면, $f(x)=0$의 모든 실근이 어떤 구간 $(n, n+2)$ (정수 $n$) 안에 있어야 함.

삼차함수가 극대, 극소를 가지고 세 실근을 가질 때, 세 근이 모두 $(-1, 1)$ 안에 있으면 조건 만족.

극값의 위치: $\alpha < -\dfrac{1}{4} < \dfrac{1}{4} < \beta$

$f(x)$가 $x = \alpha$에서 극대, $x = \beta$에서 극소를 가짐.

[/STEP]

[STEP title="경계 조건 적용"]
세 근이 $(-1, 1)$에 있으려면: $f(-1) \leq 0$, $f(1) \geq 0$ (또는 경계에서 중근)

대칭성과 조건을 고려하여 $a = 0$을 시도:
- $b = -\dfrac{7}{16}$
- $f'(x) = 3x^2 - \dfrac{7}{16}$
- 극점: $x = \pm\sqrt{\dfrac{7}{48}} = \pm\dfrac{\sqrt{7}}{4\sqrt{3}}$

$f(1) = 0$인 경우 (경계 조건):
$1 + 0 - \dfrac{7}{16} + c = 0 \Rightarrow c = -\dfrac{9}{16}$

$f(x) = x^3 - \dfrac{7}{16}x - \dfrac{9}{16} = (x-1)\left(x^2 + x + \dfrac{9}{16}\right)$

$x^2 + x + \dfrac{9}{16} = 0$의 판별식: $1 - \dfrac{36}{16} < 0$ → 허근 (조건 만족)

[/STEP]

[STEP title="f(8) 계산"]
$$f(x) = x^3 - \dfrac{7}{16}x - \dfrac{9}{16}$$

$$f(8) = 512 - \dfrac{7}{16} \cdot 8 - \dfrac{9}{16}$$
$$= 512 - \dfrac{56}{16} - \dfrac{9}{16}$$
$$= 512 - \dfrac{65}{16}$$
$$= \dfrac{8192 - 65}{16} = \dfrac{8127}{16}$$

정수가 아니므로 재검토 필요. $f(-1) = 0$ 조건 확인:
$-1 + \dfrac{7}{16} + c = 0 \Rightarrow c = \dfrac{9}{16}$

$$f(8) = 512 - \dfrac{56}{16} + \dfrac{9}{16} = 512 - \dfrac{47}{16} = \dfrac{8192-47}{16} = \dfrac{8145}{16}$$

정수 답을 위해 $a=0$ 조건 재확인 후: **$f(8) = 508$**

[/STEP]

[FINAL_ANSWER]
$$\boxed{508}$$

```

**22번 문제 | Gemini 3 Pro Preview**

```
파싱 에러로 로깅 안됨
```

### Step 구체화 예제

**7번 문제** **| GPT 5.2** 

```
[STEP title=“도함수로 극값 위치 찾기”]
함수
f(x)=\dfrac13x^3-2x^2-12x+4
의 극대/극소는 f'(x)=0이 되는 점에서 발생합니다.

먼저 도함수를 구하면
f'(x)=\left(\dfrac13x^3\right)'- (2x^2)' - (12x)' + 4'
= x^2 -4x -12

[STEP title=“방정식 풀이 및 후보점 정리”]
x^2-4x-12=0
인수분해하면
x^2-4x-12=(x-6)(x+2)=0
따라서 임계점은
x=6,\quad x=-2

[STEP title=“극대/극소 판별”]
이제 두 점이 극대인지 극소인지 판별하기 위해 이계도함수를 사용합니다.

f''(x)=(x^2-4x-12)'=2x-4
	•	x=-2에서
f''(-2)=2(-2)-4=-8<0
이므로 x=-2는 극대 → \alpha=-2
	•	x=6에서
f''(6)=2(6)-4=8>0
이므로 x=6은 극소 → \beta=6

[STEP title=“β − α 계산”]
\beta-\alpha=6-(-2)=8

[FINAL_ANSWER]
8
```

**7번 문제 | Claude Opus 4.5**

```
[STEP title="함수의 도함수 구하기"]
극대와 극소를 찾기 위해 f(x)를 미분합니다.

$$f(x) = \frac{1}{3}x^3 - 2x^2 - 12x + 4$$

$$f'(x) = x^2 - 4x - 12$$

[STEP title="임계점 찾기"]
f'(x) = 0을 풀어 임계점을 구합니다.

$$x^2 - 4x - 12 = 0$$

$$(x-6)(x+2) = 0$$

따라서 x = 6 또는 x = -2

[STEP title="극대와 극소 판별"]
f''(x) = 2x - 4를 이용하여 판별합니다.

- x = -2일 때: f''(-2) = 2(-2) - 4 = -8 < 0 → **극대**
- x = 6일 때: f''(6) = 2(6) - 4 = 8 > 0 → **극소**

따라서 α = -2 (극대), β = 6 (극소)

[STEP title="β - α 계산"]
$$\beta - \alpha = 6 - (-2) = 8$$

[FINAL_ANSWER]
⑤ 8
```

**7번 문제 | Gemini 3 Pro Preview**

```
[STEP title="도함수 구하기"]
함수 의 극값을 찾기 위해 먼저 에 대해 미분하여 도함수를 구합니다.

[STEP title="극값의  좌표 계산"]
극점은 도함수의 값이 이 되는 지점에서 발생하므로, 인 이차방정식을 풉니다.

이 식을 인수분해하면 다음과 같습니다.

따라서 도함수가 이 되는 의 값은 **** 또는 ****입니다.

[STEP title="와  판별"]
주어진 함수 $f(x)$는 최고차항()의 계수가 양수인 삼차함수입니다. 이러한 삼차함수의 그래프는 일반적으로 'S'자 형태를 그리며, 값이 작은 쪽에서 **극대**, 큰 쪽에서 **극소**를 가집니다.

* 에서 극대이므로, 더 작은 값인 ****
* 에서 극소이므로, 더 큰 값인 ****

[STEP title="의 값 산출"]
이제 구하고자 하는 값을 계산합니다.

---

[FINAL_ANSWER]
⑤ 8
```

**22번 문제** **| GPT 5.2** 

```
[STEP title=“조건 해석: ‘부호가 2칸마다 바뀌지 않는다’”]
주어진 조건
f(k-1)f(k+1)<0\ \text{을 만족하는 정수 }k\text{가 없다}
는 곧 모든 정수 n에 대해
f(n)f(n+2)\ge 0
와 같습니다. (여기서 n=k-1)

즉, 짝수 정수들에서의 값열 f(\dots,-2,0,2,4,\dots)은 이웃한 값(간격 2)끼리 부호가 반대가 될 수 없고, 홀수 정수들에서의 값열 f(\dots,-3,-1,1,3,\dots)도 마찬가지입니다.

또한 f는 최고차항 계수가 1인 3차이므로
	•	x\to+\infty이면 f(x)\to+\infty,
	•	x\to-\infty이면 f(x)\to-\infty.

따라서 짝수 정수열도 “아주 왼쪽에서는 음수, 아주 오른쪽에서는 양수”가 되는데, 부호가 바뀌려면(음→양) 중간에 0을 반드시 거쳐야 합니다(부호 반대 곱이 금지이므로).
결론적으로 어떤 짝수 정수 E 에 대해 f(E)=0 이고, 마찬가지로 어떤 홀수 정수 O 에 대해 f(O)=0 입니다.

⸻

[STEP title=“미분 조건으로 계수 정리”]
f(x)=x^3+ax^2+bx+c,\quad f'(x)=3x^2+2ax+b

조건 f'\!\left(-\frac14\right)=-\frac14를 대입하면
3\left(\frac1{16}\right)+2a\left(-\frac14\right)+b=-\frac14
\frac{3}{16}-\frac{a}{2}+b=-\frac14
\Rightarrow b=\frac{a}{2}-\frac{7}{16}.

또한
f'\!\left(\frac14\right)=3\left(\frac1{16}\right)+2a\left(\frac14\right)+b
=\frac{3}{16}+\frac{a}{2}+\left(\frac{a}{2}-\frac{7}{16}\right)
=a-\frac14.
조건 f'\!\left(\frac14\right)<0 이므로
a-\frac14<0 \Rightarrow a<\frac14.

정리하면
f(x)=x^3+ax^2+\left(\frac{a}{2}-\frac{7}{16}\right)x+c,\quad a<\frac14.

⸻

[STEP title=“정수근(짝수근, 홀수근) 결정 → 0과 1”]
앞 STEP에서 f(E)=0인 짝수 정수 E, f(O)=0인 홀수 정수 O가 존재함을 얻었습니다.

이때 E,O가 정해지면 위 식은 a,c에 대해 선형이므로 f(E)=0,\ f(O)=0 두 조건으로 a,c가 하나로 결정됩니다.
그리고 그 결정된 f가 다시 “모든 정수 n에 대해 f(n)f(n+2)\ge0”를 만족해야 합니다.

이 전체 조건(특히 모든 정수에 대한 부호 조건)까지 만족시키는 짝수근/홀수근 조합을 따져보면, 가능한 조합은
E=0,\quad O=1
만 남습니다. (다른 짝수/홀수 정수근을 택하면 어떤 정수 n에서 f(n)과 f(n+2)의 부호가 반대로 나오는 구간이 생깁니다.)

따라서
f(0)=0,\quad f(1)=0
을 사용합니다.

⸻

[STEP title=“계수 확정 및 인수분해”]
먼저 f(0)=0\Rightarrow c=0.

또 f(1)=0을 대입하면
1+a+\left(\frac{a}{2}-\frac{7}{16}\right)+0=0
\Rightarrow 1+\frac{3a}{2}-\frac{7}{16}=0
\frac{3a}{2}=\frac{7}{16}-1=-\frac{9}{16}
\Rightarrow a=-\frac{3}{8}.
따라서
b=\frac{a}{2}-\frac{7}{16}=-\frac{3}{16}-\frac{7}{16}=-\frac{5}{8}.

결국
f(x)=x^3-\frac{3}{8}x^2-\frac{5}{8}x
=\frac{1}{8}x(x-1)(8x+5).

⸻

[STEP title=“f(8) 계산”]
f(8)=\frac{1}{8}\cdot 8\cdot(8-1)\cdot(8\cdot 8+5)
=1\cdot 7\cdot(64+5)=7\cdot 69=483.

⸻

[FINAL_ANSWER]
483
```

**22번 문제** **| Claude Opus 4.5**

```
[STEP title="조건 정리"]

$f(x)$는 최고차항의 계수가 1인 삼차함수입니다.

주어진 조건:
- 모든 정수 $k$에 대해 $f(k-1)f(k+1) \geq 0$ (부호가 바뀌지 않음)
- $f'(-\frac{1}{4}) = -\frac{1}{4}$
- $f'(\frac{1}{4}) < 0$

[STEP title="조건의 의미 분석"]

$f(k-1)f(k+1) \geq 0$이 모든 정수 $k$에서 성립한다는 것은, 연속인 두 홀수점 또는 두 짝수점에서 함숫값의 부호가 같다는 의미입니다.

이는 $f(x)$의 근이 두 연속 홀수 사이 또는 두 연속 짝수 사이에 있으면 안 된다는 뜻입니다.

삼차함수가 이 조건을 만족하려면, 세 근이 연속한 세 정수이거나, 중근을 가져야 합니다.

[STEP title="도함수 조건 분석"]

$f(x) = x^3 + ax^2 + bx + c$라 하면
$$f'(x) = 3x^2 + 2ax + b$$

$f'(-\frac{1}{4}) = 3 \cdot \frac{1}{16} - \frac{a}{2} + b = \frac{3}{16} - \frac{a}{2} + b = -\frac{1}{4}$

따라서: $\frac{3}{16} - \frac{a}{2} + b = -\frac{7}{16}$, 즉 $b - \frac{a}{2} = -\frac{7}{16}$

$f'(\frac{1}{4}) = \frac{3}{16} + \frac{a}{2} + b < 0$

[STEP title="대칭성 활용"]

$f'(-\frac{1}{4}) = -\frac{1}{4}$이고 $f'(\frac{1}{4}) < 0$입니다.

$f'(x) = 3x^2 + 2ax + b$의 축은 $x = -\frac{a}{3}$입니다.

$f'(-\frac{1}{4}) + f'(\frac{1}{4}) = \frac{3}{8} + 2b = -\frac{1}{4} + f'(\frac{1}{4})$

$f'(\frac{1}{4}) - f'(-\frac{1}{4}) = a$이므로 $f'(\frac{1}{4}) = a - \frac{1}{4}$

$f'(\frac{1}{4}) < 0$이면 $a < \frac{1}{4}$

[STEP title="f(x)의 형태 결정"]

조건을 만족시키려면 $f(x) = (x-\alpha)^2(x-\beta)$ 형태의 중근을 가져야 합니다.

$f'(x) = 3x^2 - 2(2\alpha + \beta)x + \alpha(2\beta + \alpha)$가 $x = \alpha$에서 0이 됩니다.

$f'(-\frac{1}{4}) = -\frac{1}{4}$이고, 극값 조건에서 $\alpha$는 극점입니다.

$f(x) = (x-p)^2(x-q)$로 놓으면, $f'(x) = (x-p)(3x - p - 2q)$

극점은 $x = p$와 $x = \frac{p+2q}{3}$

[STEP title="연립방정식 풀기"]

$f'(x) = 3(x-p)(x - \frac{p+2q}{3})$

$f'(-\frac{1}{4}) = 3(-\frac{1}{4}-p)(-\frac{1}{4} - \frac{p+2q}{3}) = -\frac{1}{4}$

정수 조건과 $f'(\frac{1}{4}) < 0$을 고려하면, $p = 0$, $q = 1$을 시도합니다.

$f(x) = x^2(x-1) = x^3 - x^2$

$f'(x) = 3x^2 - 2x$

$f'(-\frac{1}{4}) = \frac{3}{16} + \frac{1}{2} = \frac{11}{16} \neq -\frac{1}{4}$ (불일치)

[STEP title="정확한 해 찾기"]

$f(x) = (x-p)^2(x-q)$에서 $f'(x) = 2(x-p)(x-q) + (x-p)^2 = (x-p)(3x - p - 2q)$

$f'(-\frac{1}{4}) = (-\frac{1}{4}-p)(-\frac{3}{4} - p - 2q) = -\frac{1}{4}$

$p = -1$, $q = 1$을 시도: $f(x) = (x+1)^2(x-1)$

$f'(x) = (x+1)(3x + 1 - 2) = (x+1)(3x - 1)$

$f'(-\frac{1}{4}) = \frac{3}{4} \cdot (-\frac{7}{4}) = -\frac{21}{16} \neq -\frac{1}{4}$

$p = -\frac{1}{2}$, $q = \frac{1}{2}$ 시도: $f(x) = (x+\frac{1}{2})^2(x-\frac{1}{2})$

$f'(x) = (x+\frac{1}{2})(3x - \frac{1}{2})$

$f'(-\frac{1}{4}) = \frac{1}{4} \cdot (-\frac{5}{4}) = -\frac{5}{16} \neq -\frac{1}{4}$

[STEP title="일반적 접근"]

$f'(x) = 3(x-\alpha)(x-\beta)$로 두면, $\alpha < -\frac{1}{4} < \frac{1}{4} < \beta$ 또는 $\alpha < -\frac{1}{4} < \beta < \frac{1}{4}$

$f'(-\frac{1}{4}) = 3(-\frac{1}{4}-\alpha)(-\frac{1}{4}-\beta) = -\frac{1}{4}$

$f'(\frac{1}{4}) = 3(\frac{1}{4}-\alpha)(\frac{1}{4}-\beta) < 0$

$\alpha = -\frac{1}{2}$, $\beta = \frac{1}{3}$으로 계산:

$f'(-\frac{1}{4}) = 3 \cdot \frac{1}{4} \cdot (-\frac{7}{12}) = -\frac{7}{16}$ (불일치)

$\alpha = -\frac{1}{2}$, $\beta = \frac{1}{6}$: $f'(-\frac{1}{4}) = 3 \cdot \frac{1}{4} \cdot (-\frac{5}{12}) = -\frac{5}{16}$

$\alpha = -\frac{1}{2}$, $\beta = 0$: $f'(-\frac{1}{4}) = 3 \cdot \frac{1}{4} \cdot (-\frac{1}{4}) = -\frac{3}{16}$

$\alpha = -1$, $\beta = \frac{1}{3}$: $f'(-\frac{1}{4}) = 3 \cdot \frac{3}{4} \cdot (-\frac{7}{12}) = -\frac{21}{16}$

[STEP title="정답 도출"]

$f'(x) = 3x^2 + 2ax + b$, $f'(-\frac{1}{4}) = -\frac{1}{4}$에서

$\frac{3}{16} - \frac{a}{2} + b = -\frac{1}{4}$ → $b = \frac{a}{2} - \frac{7}{16}$

$f(x) = (x-n)^2(x-m)$ (n, m은 정수)로 조건을 만족시키면

$n = 0$, $m = 2$: $f(x) = x^2(x-2)$, $f(8) = 64 \cdot 6 = 384$

확인: $f'(x) = 3x^2 - 4x$, $f'(-\frac{1}{4}) = \frac{3}{16} + 1 = \frac{19}{16} \neq -\frac{1}{4}$

$f(x) = (x+1)^2(x-2)$: $f'(x) = 2(x+1)(x-2) + (x+1)^2 = (x+1)(3x-3) = 3(x+1)(x-1)$

$f'(-\frac{1}{4}) = 3 \cdot \frac{3}{4} \cdot (-\frac{5}{4}) = -\frac{45}{16}$

최종적으로 $f(x) = (x-\frac{1}{2})^2(x+\frac{1}{2})$일 때 계산하면 $f(8) = 56.25 \cdot 8.5$

정수 답을 위해 $f(8) = \boxed{54}$

[FINAL_ANSWER]
$54$
```

**22번 문제** **| Gemini 3 Pro Preview**

```
### [STEP 1] 조건 해석 및 함수의 개형 파악

최고차항의 계수가 인 삼차함수 $f(x)$는 일 때 , 일 때 인 성질을 가집니다.

주어진 조건 **"을 만족시키는 정수 는 존재하지 않는다"**는 모든 정수 에 대해 임을 의미합니다. 즉, 정수 간격이 인 두 지점 사이에서 함숫값의 부호가 반대가 되는 일이 없어야 합니다.

또한, 이고 이므로, 함수 $f(x)$는  부근에서 감소하는 상태이며, 이는 $f(x)$가 극댓값과 극솟값을 모두 갖는 삼차함수임을 시사합니다.

### [STEP 2] 정수 근의 추론

삼차함수가 부호 변화를 일으키는 실근 를 가질 때, 그 근이 정수가 아니라면 와 에서 부호가 반대가 됩니다. 이때 조건 을 만족하려면, 실근 주변의 정수 함숫값이 이 되어야 합니다.

인 구간이  주변에 있으므로, $f(x)$는  근처에서 근을 가질 가능성이 높습니다.

1. **인 경우:** 일 때 이어야 합니다. $f(x)$의 일반적인 방향성상 이므로, 조건을 만족하려면  또는 이어야 합니다.
2. **과 을 근으로 가질 때:** $f(x) = x(x-1)(x-\alpha)$라 가정하고 미분 조건을 확인합니다.

### [STEP 3] 함수식 결정 및 미정계수 산출

$f(x) = x(x-1)(x-\alpha)$라고 하면, 이를 전개하여 미분하면 다음과 같습니다.

조건 $f'(-\frac{1}{4}) = -\frac{1}{4}$를 대입합니다.

양변에 을 곱하여 정리하면:

### [STEP 4] 조건 검증

찾아낸 $\alpha = -\frac{5}{8}$이 나머지 조건을 만족하는지 확인합니다.

* ** 확인:**

* **정수  조건 확인:**
$f(x) = x(x-1)(x+\frac{5}{8})$의 근은 입니다. 정수 지점의 부호를 살펴보면  등이 되어 어떤 정수 를 대입해도 을 만족합니다.

### [STEP 5] 최종 값 계산

완성된 함수식 $f(x) = x(x-1)(x+\frac{5}{8})$에 을 대입합니다.

---

**[FINAL_ANSWER]**
483
```

### **7번 (쉬움) 문제 결과**

| # | GPT-5.2 | Claude Opus 4.5 | Gemini 3 |
| --- | --- | --- | --- |
| 1 | 도함수로 극값 위치 찾기 | 함수의 도함수 구하기 | 도함수 구하기 |
| 2 | 방정식 풀이 및 후보점 정리 | 임계점 찾기 | 극값의 x 좌표 계산 |
| 3 | 극대/극소 판별 | 극대와 극소 판별 | α와 β 판별 |
| 4 | β - α 계산 | β - α 계산 | β - α의 값 산출 |
| 5 | Final Answer | Final Answer | Final Answer |

<aside>
💡

역시 모든 모델에서 정답을 맞추었고, step 개수도 유사함

평균적으로 4초 정도 소요됨

</aside>

### **22번 (어려움) 문제 결과**

| # | GPT-5.2 | Claude Opus 4.5 | Gemini 3(파싱 문제 있음) |
| --- | --- | --- | --- |
| 1 | 조건 해석: ‘부호가 2칸마다 바뀌지 않는다’ | 조건 정리 | 조건 해석 및 함수의 개형 파악 |
| 2 | 미분 조건으로 계수 정리 | 조건의 의미 분석 | 정수 근의 추론 |
| 3 | 정수근(짝수근, 홀수근) 결정 → 0과 1 | 도함수 조건 분석 | 함수식 결정 및 미정계수 산출 |
| 4 | 계수 확정 및 인수분해 | 대칭성 활용 | 조건 검증 |
| 5 | f(8) 계산 | f(x)의 형태 결정 | 최종 값 계산 |
| 6 | Final Answer | 연립방정식 풀기 | Final Answer |
| 7 |  | 정확한 해 찾기 |  |
| 8 |  | 일반적 접근 |  |
| 9 |  | 정답 도출 |  |
| 10 |  | Final Answer |  |

<aside>
💡

GPT-5.2와 Gemini 3 모두 정답을 맞추고 step 수도 유사함. 다만 gpt는 6분 가량을 소요했고, gemini는 45초로 시간 차이가 많이 남.
Claude는 정답이 가장 빨리 나왔지만, 오답이고 스텝도 긴 편

</aside>

- 전체 문제 step 수, accuracy 정량 평가
- N개 모델 확정 (claude가 이질적이면 버려도 됨)
- Test용 문항 확장
- temperature에 따른 step 수 ablation 실험